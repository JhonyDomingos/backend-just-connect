generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id                 String          @id @default(uuid())
  name               String?         @db.VarChar(100)
  username           String          @unique @db.VarChar(20)
  email              String          @unique
  password           String          @db.VarChar(60)
  bio_description    String?         @db.VarChar(140)
  admin_user_block   Boolean         @default(false)
  linkedin           String?         @unique
  instagram          String?         @unique
  github             String?         @unique
  role               Role            @default(USER)
  created_at         DateTime        @default(now())
  updated_at         DateTime?       @updatedAt
  reset_token        String?         @unique
  reset_token_expiry DateTime?
  comment_like       CommentLike[]
  comment_reports    CommentReport[]
  comments           Comment[]
  post_like          PostLike[]
  post_reports       PostReport[]
  posts              Post[]
  tag_follow         TagFollow[]

  @@map("users")
}

model Post {
  id               String       @id @default(uuid())
  title            String       @db.VarChar(50)
  description      String
  admin_post_block Boolean      @default(false)
  user_id          String
  created_at       DateTime     @default(now())
  updated_at       DateTime?    @updatedAt
  score            Int          @default(0)
  status_open      Boolean      @default(true)
  comment          Comment[]
  post_like        PostLike[]
  post_reports     PostReport[]
  user             User         @relation(fields: [user_id], references: [id], onDelete: Cascade)
  tags             Tag[]        @relation("PostToTag")

  @@map("posts")
}

model Comment {
  id                  String          @id @default(uuid())
  comment             String
  score               Int             @default(0)
  admin_comment_block Boolean         @default(false)
  post_id             String
  user_id             String
  created_at          DateTime        @default(now())
  updated_at          DateTime?       @updatedAt
  comment_like        CommentLike[]
  comment_reports     CommentReport[]
  post                Post            @relation(fields: [post_id], references: [id], onDelete: Cascade)
  user                User            @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@map("comments")
}

model Tag {
  id         String      @id @default(uuid())
  tag        String      @unique @db.VarChar(15)
  tag_follow TagFollow[]
  posts      Post[]      @relation("PostToTag")

  @@map("tags")
}

model PostReport {
  id               String     @id @default(uuid())
  user_id          String
  post_id          String
  type_report      TypeReport
  post_report      String     @db.VarChar(140)
  created_at       DateTime   @default(now())
  updated_at       DateTime?  @updatedAt
  admin_validation Boolean    @default(false)
  post             Post       @relation(fields: [post_id], references: [id], onDelete: Cascade)
  user             User       @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@map("postreport")
}

model PostLike {
  id         String   @id @default(uuid())
  user_id    String
  post_id    String
  created_at DateTime @default(now())
  post       Post     @relation(fields: [post_id], references: [id], onDelete: Cascade)
  user       User     @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@map("postlike")
}

model CommentReport {
  id               String     @id @default(uuid())
  user_id          String
  comment_id       String
  type_report      TypeReport
  post_report      String     @db.VarChar(140)
  created_at       DateTime   @default(now())
  updated_at       DateTime?  @updatedAt
  admin_validation Boolean    @default(false)
  comment          Comment    @relation(fields: [comment_id], references: [id], onDelete: Cascade)
  user             User       @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@map("commentreport")
}

model CommentLike {
  id         String   @id @default(uuid())
  user_id    String
  comment_id String
  created_at DateTime @default(now())
  comment    Comment  @relation(fields: [comment_id], references: [id], onDelete: Cascade)
  user       User     @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@map("commentlike")
}

model TagFollow {
  id         String   @id @default(uuid())
  user_id    String
  tag_id     String
  created_at DateTime @default(now())
  tag        Tag      @relation(fields: [tag_id], references: [id], onDelete: Cascade)
  user       User     @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@map("tagFollow")
}

model Notification {
  id         String   @id @default(uuid())
  user_id    String
  type       String   @db.VarChar(15)
  username   String
  message    String
  is_read    Boolean  @default(false)
  related_id String?
  created_at DateTime @default(now())

  @@map("notifications")
}

enum Role {
  USER
  ADMIN
}

enum TypeReport {
  Spam
  FraudeGolpe
  ExposicaoDeViolencia
  Assedio
  NudezPornografia
  DiscursoDeOdio
  VendaDeProdutosIlicitos
}
